<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progressive 5x5 Workout Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .cycle-info {
            background: #eff6ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #3b82f6;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .week-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .week-btn {
            padding: 10px 20px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .week-btn:hover {
            background: #f0f0f0;
        }
        
        .week-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .week-btn.deload {
            background: #fef3c7;
            border-color: #fbbf24;
        }
        
        .week-btn.deload.active {
            background: #fbbf24;
            color: #78350f;
        }
        
        .alert {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .alert-warning {
            background: #fef3c7;
            border-left-color: #f59e0b;
        }
        
        .alert-success {
            background: #d1fae5;
            border-left-color: #10b981;
        }
        
        .alert h3 {
            margin-bottom: 10px;
            color: #1e40af;
        }
        
        .alert-warning h3 {
            color: #92400e;
        }
        
        .alert-success h3 {
            color: #166534;
        }
        
        .alert ul {
            margin-left: 20px;
        }
        
        .workout-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .day-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .day-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .day-card.selected {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .day-header h3 {
            color: #333;
        }
        
        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            background: #10b981;
            height: 100%;
            transition: width 0.3s;
        }
        
        .workout-detail {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .exercise-card {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .exercise-card.complete {
            background: #d1fae5;
            border-color: #10b981;
        }
        
        .exercise-card.failed {
            background: #fee2e2;
            border-color: #ef4444;
        }
        
        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }
        
        .exercise-name {
            font-weight: 600;
            font-size: 1.1em;
            color: #333;
        }
        
        .exercise-notes {
            color: #6b7280;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .exercise-stats {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            font-weight: 600;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .stat-label {
            color: #6b7280;
            font-size: 0.9em;
        }
        
        .weight-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .weight-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .weight-badge.increase {
            background: #dcfce7;
            color: #166534;
        }
        
        .weight-badge.same {
            background: #fef3c7;
            color: #92400e;
        }
        
        .weight-badge.decrease {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .weight-badge.deload {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .set-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 15px;
        }
        
        .set-btn {
            padding: 12px;
            border: 2px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .set-btn:hover {
            background: #f3f4f6;
        }
        
        .set-btn.complete {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }
        
        .set-btn.failed {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }
        
        .completion-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
        }
        
        .completion-status.success {
            background: #dcfce7;
            color: #166534;
            border: 2px solid #10b981;
        }
        
        .completion-status.incomplete {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }
        
        .completion-status.pending {
            background: #fef3c7;
            color: #92400e;
            border: 2px solid #fbbf24;
        }
        
        .weight-adjustment {
            margin-top: 20px;
            padding: 20px;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }
        
        .weight-adjustment h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .adjustment-grid {
            display: grid;
            gap: 15px;
        }
        
        .adjustment-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
        }
        
        .adjustment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .adjustment-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .adj-btn {
            padding: 8px 16px;
            border: 2px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            font-size: 0.9em;
        }
        
        .adj-btn:hover {
            background: #f3f4f6;
        }
        
        .adj-btn.selected {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .adj-btn.recommended {
            border-color: #10b981;
            background: #d1fae5;
            color: #166534;
        }
        
        .recommendation {
            font-size: 0.9em;
            color: #6b7280;
            margin-top: 5px;
            font-style: italic;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .modal-content h2 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .export-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-top: 20px;
            text-align: center;
        }
        
        .btn {
            padding: 12px 24px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #2563eb;
        }
        
        .btn-secondary {
            background: #6b7280;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #10b981;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .hidden {
            display: none;
        }
        
        @media print {
            body {
                background: white;
            }
            .controls, .export-section, .set-btn, .weight-adjustment {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Progressive 5x5 Dumbbell Program</h1>
            <p>Building strength and muscle at home - Track your progress below</p>
            <div class="cycle-info" id="cycleInfo"></div>
        </div>
        
        <div class="controls">
            <h2>Select Week</h2>
            <div class="week-selector" id="weekSelector"></div>
        </div>
        
        <div class="alert" id="weekAlert"></div>
        
        <div class="alert alert-warning">
            <h3>How Weight Progression Works</h3>
            <ul>
                <li><strong>Mark sets:</strong> Click once for âœ“ (complete), twice for âœ— (failed)</li>
                <li><strong>After completing a day:</strong> Review weight adjustments at the bottom</li>
                <li><strong>Smart suggestions:</strong> System recommends increases/decreases based on performance</li>
                <li><strong>Your choice:</strong> Select +3, +5, +10 lbs, stay same, or decrease</li>
                <li>Every 4th week is automatic deload (70% weight)</li>
                <li>Rest 90-120 seconds between sets</li>
            </ul>
        </div>
        
        <div class="workout-grid" id="workoutGrid"></div>
        
        <div id="workoutDetail" class="hidden"></div>
        
        <div class="export-section">
            <h3>Manage Your Program</h3>
            <p style="margin: 10px 0;">Save your progress or start fresh</p>
            <button class="btn" onclick="exportToCSV()">Download as CSV</button>
            <button class="btn btn-secondary" onclick="window.print()">Print Workout</button>
            <button class="btn btn-danger" onclick="resetData()">Reset All Progress</button>
        </div>
    </div>

    <div class="modal" id="cycleModal">
        <div class="modal-content">
            <h2>ðŸŽ‰ Cycle Complete!</h2>
            <p style="margin: 15px 0;">You've completed 12 weeks of training. Great work!</p>
            <p style="margin: 15px 0;">Would you like to start a new cycle? Your current weights will become the starting point for the next cycle.</p>
            <div class="modal-buttons">
                <button class="btn btn-success" onclick="startNewCycle()">Start New Cycle</button>
                <button class="btn btn-secondary" onclick="closeModal()">Stay on Week 12</button>
            </div>
        </div>
    </div>

    <script>
        var program = {
            1: {
                name: "Upper Body Push",
                exercises: [
                    { name: "Incline Dumbbell Press", sets: 5, reps: 5, startWeight: 25, notes: "Focus on upper chest" },
                    { name: "Standing Overhead Press", sets: 5, reps: 5, startWeight: 20, notes: "Strict form" },
                    { name: "Dumbbell Floor Press", sets: 5, reps: 5, startWeight: 30, notes: "Protect shoulders" },
                    { name: "Lateral Raises", sets: 3, reps: 12, startWeight: 10, notes: "Slight bend in elbow" },
                    { name: "Overhead Tricep Extension", sets: 3, reps: 10, startWeight: 20, notes: "Both arms, one DB" }
                ]
            },
            2: {
                name: "Lower Body",
                exercises: [
                    { name: "Goblet Squats", sets: 5, reps: 5, startWeight: 40, notes: "Hold one DB at chest" },
                    { name: "Romanian Deadlifts", sets: 5, reps: 5, startWeight: 30, notes: "Each hand, hinge at hips" },
                    { name: "Bulgarian Split Squats", sets: 4, reps: 8, startWeight: 20, notes: "Each leg" },
                    { name: "Dumbbell Lunges", sets: 3, reps: 10, startWeight: 20, notes: "Each leg, walking" },
                    { name: "Calf Raises", sets: 3, reps: 15, startWeight: 30, notes: "On step, hold DBs" }
                ]
            },
            3: {
                name: "Cardio & Core",
                exercises: [
                    { name: "Treadmill Jog/Walk Intervals", sets: 1, reps: 20, startWeight: 0, notes: "20 min: 2 min jog, 1 min walk" },
                    { name: "Plank", sets: 3, reps: 1, startWeight: 0, notes: "Hold 30-60 seconds" },
                    { name: "Russian Twists", sets: 3, reps: 20, startWeight: 15, notes: "Hold one DB" },
                    { name: "Dumbbell Side Bends", sets: 3, reps: 15, startWeight: 25, notes: "Each side" },
                    { name: "Lying Leg Raises", sets: 3, reps: 12, startWeight: 0, notes: "Slow and controlled" }
                ]
            },
            4: {
                name: "Upper Body Pull",
                exercises: [
                    { name: "Bent Over Dumbbell Rows", sets: 5, reps: 5, startWeight: 35, notes: "Pull to hip, each arm" },
                    { name: "Single Arm Row", sets: 4, reps: 8, startWeight: 40, notes: "Each arm, on bench" },
                    { name: "Dumbbell Pullover", sets: 4, reps: 10, startWeight: 30, notes: "Chest/back combo" },
                    { name: "Hammer Curls", sets: 4, reps: 10, startWeight: 20, notes: "Palms facing each other" },
                    { name: "Reverse Flyes", sets: 3, reps: 12, startWeight: 12, notes: "Rear delts" }
                ]
            },
            5: {
                name: "Full Body & Cardio",
                exercises: [
                    { name: "Dumbbell Clean and Press", sets: 4, reps: 8, startWeight: 25, notes: "Explosive, full body" },
                    { name: "Goblet Squats", sets: 4, reps: 8, startWeight: 40, notes: "Same as Day 2" },
                    { name: "Push-ups", sets: 3, reps: 15, startWeight: 0, notes: "On knees if needed" },
                    { name: "Dumbbell Swings", sets: 3, reps: 15, startWeight: 30, notes: "Hip drive, one DB" },
                    { name: "Treadmill Intervals", sets: 1, reps: 15, startWeight: 0, notes: "15 min: 1 min fast, 1 min slow" }
                ]
            }
        };

        var currentCycle = parseInt(localStorage.getItem('currentCycle') || '1');
        var currentWeek = parseInt(localStorage.getItem('currentWeek') || '1');
        var selectedDay = null;

        function getCycleKey(cycle, week, day, exerciseIndex) {
            return 'c' + cycle + '-w' + week + '-d' + day + '-e' + exerciseIndex;
        }

        function getWeekType(week) {
            return week % 4 === 0 ? "deload" : "normal";
        }

        function getSavedWeight(cycle, week, day, exerciseIndex) {
            var key = getCycleKey(cycle, week, day, exerciseIndex) + '-weight';
            var saved = localStorage.getItem(key);
            return saved ? parseFloat(saved) : null;
        }

        function saveWeight(cycle, week, day, exerciseIndex, weight) {
            var key = getCycleKey(cycle, week, day, exerciseIndex) + '-weight';
            localStorage.setItem(key, weight);
        }

        function getManualAdjustment(cycle, week, day, exerciseIndex) {
            var key = getCycleKey(cycle, week, day, exerciseIndex) + '-adjustment';
            var saved = localStorage.getItem(key);
            return saved ? parseFloat(saved) : null;
        }

        function saveManualAdjustment(cycle, week, day, exerciseIndex, adjustment) {
            var key = getCycleKey(cycle, week, day, exerciseIndex) + '-adjustment';
            localStorage.setItem(key, adjustment);
        }

        function getExercisePerformance(cycle, week, day, exerciseIndex, totalSets) {
            var completed = 0;
            var failed = 0;
            for (var i = 1; i <= totalSets; i++) {
                var progress = getProgress(cycle, week, day, exerciseIndex, i);
                if (progress === 'complete') completed++;
                else if (progress === 'failed') failed++;
            }
            return { completed: completed, failed: failed, total: totalSets };
        }

        function didCompleteExerciseLastWeek(cycle, week, day, exerciseIndex, totalSets) {
            if (week <= 1) {
                if (cycle <= 1) return true;
                week = 12;
                cycle = cycle - 1;
            } else {
                week = week - 1;
            }
            
            var perf = getExercisePerformance(cycle, week, day, exerciseIndex, totalSets);
            return perf.completed === totalSets;
        }

        function didFailExerciseLastWeek(cycle, week, day, exerciseIndex, totalSets) {
            if (week <= 1) {
                if (cycle <= 1) return false;
                week = 12;
                cycle = cycle - 1;
            } else {
                week = week - 1;
            }
            
            var perf = getExercisePerformance(cycle, week, day, exerciseIndex, totalSets);
            return perf.failed > 0 || perf.completed < totalSets;
        }

        function getWeightForWeek(startWeight, cycle, week, day, exerciseIndex, totalSets) {
            if (startWeight === 0) return 0;
            
            var weekType = getWeekType(week);
            var saved = getSavedWeight(cycle, week, day, exerciseIndex);
            
            if (saved !== null) {
                if (weekType === "deload") {
                    return Math.round(saved * 0.7);
                }
                return saved;
            }
            
            if (cycle === 1 && week === 1) {
                saveWeight(cycle, week, day, exerciseIndex, startWeight);
                return startWeight;
            }
            
            var prevCycle = cycle;
            var prevWeek = week - 1;
            
            if (prevWeek < 1) {
                prevCycle = cycle - 1;
                prevWeek = 12;
            }
            
            if (prevCycle < 1) {
                saveWeight(cycle, week, day, exerciseIndex, startWeight);
                return startWeight;
            }
            
            var prevWeekType = getWeekType(prevWeek);
            var prevWeight = getWeightForWeek(startWeight, prevCycle, prevWeek, day, exerciseIndex, totalSets);
            
            if (prevWeekType === "deload") {
                var preDeloadWeek = prevWeek - 1;
                var preDeloadCycle = prevCycle;
                if (preDeloadWeek < 1) {
                    preDeloadCycle--;
                    preDeloadWeek = 12;
                }
                if (preDeloadCycle >= 1) {
                    prevWeight = getSavedWeight(preDeloadCycle, preDeloadWeek, day, exerciseIndex) || prevWeight / 0.7;
                }
            }
            
            var manualAdj = getManualAdjustment(prevCycle, prevWeek, day, exerciseIndex);
            var newWeight = prevWeight;
            
            if (manualAdj !== null) {
                newWeight = prevWeight + manualAdj;
            } else {
                var completedLastWeek = didCompleteExerciseLastWeek(cycle, week, day, exerciseIndex, totalSets);
                if (completedLastWeek && prevWeekType !== "deload") {
                    newWeight = prevWeight + 5;
                }
            }
            
            saveWeight(cycle, week, day, exerciseIndex, newWeight);
            
            if (weekType === "deload") {
                return Math.round(newWeight * 0.7);
            }
            
            return newWeight;
        }

        function getWeightChangeStatus(cycle, week, day, exerciseIndex, totalSets) {
            if (cycle === 1 && week === 1) return "start";
            if (getWeekType(week) === "deload") return "deload";
            
            var prevCycle = cycle;
            var prevWeek = week - 1;
            if (prevWeek < 1) {
                prevCycle--;
                prevWeek = 12;
            }
            
            if (prevCycle < 1) return "start";
            
            if (getWeekType(prevWeek) === "deload") {
                return "post-deload";
            }
            
            var manualAdj = getManualAdjustment(prevCycle, prevWeek, day, exerciseIndex);
            if (manualAdj !== null) {
                if (manualAdj > 0) return "increase";
                if (manualAdj < 0) return "decrease";
                return "same";
            }
            
            var completedLastWeek = didCompleteExerciseLastWeek(cycle, week, day, exerciseIndex, totalSets);
            return completedLastWeek ? "increase" : "same";
        }

        function saveProgress(cycle, week, day, exerciseIndex, setNum, value) {
            var key = getCycleKey(cycle, week, day, exerciseIndex) + '-s' + setNum;
            var data = JSON.parse(localStorage.getItem('workoutData') || '{}');
            data[key] = value;
            localStorage.setItem('workoutData', JSON.stringify(data));
        }

        function getProgress(cycle, week, day, exerciseIndex, setNum) {
            var key = getCycleKey(cycle, week, day, exerciseIndex) + '-s' + setNum;
            var data = JSON.parse(localStorage.getItem('workoutData') || '{}');
            return data[key] || null;
        }

        function getCompletedSets(cycle, week, day, exerciseIndex, totalSets) {
            var completed = 0;
            for (var i = 1; i <= totalSets; i++) {
                if (getProgress(cycle, week, day, exerciseIndex, i) === 'complete') completed++;
            }
            return completed;
        }

        function getFailedSets(cycle, week, day, exerciseIndex, totalSets) {
            var failed = 0;
            for (var i = 1; i <= totalSets; i++) {
                if (getProgress(cycle, week, day, exerciseIndex, i) === 'failed') failed++;
            }
            return failed;
        }

        function renderCycleInfo() {
            var info = document.getElementById('cycleInfo');
            info.innerHTML = '<strong>Cycle ' + currentCycle + '</strong> - Week ' + currentWeek + ' of 12';
        }

        function renderWeekSelector() {
            var selector = document.getElementById('weekSelector');
            selector.innerHTML = '';
            
            for (var week = 1; week <= 12; week++) {
                var btn = document.createElement('button');
                btn.className = 'week-btn';
                btn.textContent = 'Week ' + week;
                
                if (getWeekType(week) === 'deload') {
                    btn.classList.add('deload');
                }
                
                if (week === currentWeek) {
                    btn.classList.add('active');
                }
                
                btn.setAttribute('data-week', week);
                btn.onclick = function() {
                    currentWeek = parseInt(this.getAttribute('data-week'));
                    localStorage.setItem('currentWeek', currentWeek);
                    selectedDay = null;
                    render();
                };
                
                selector.appendChild(btn);
            }
